<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Angular-intro :: Introduction to AngularJS</title>

    <meta name="description" content="introduction to ANgularJS for the Adept/Intermediate at programming">
    <meta name="author" content="Rhett Lowe">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">
    <link rel="stylesheet" href="css/slideStyles.css" id="theme-add">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
        document.write('<link rel="stylesheet" href="css/print/' + ( window.location.search.match(/print-pdf/gi) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">');
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides" ng-app="slides">
        <section id="opening">
            <section>
                <img class="logo" src="images/AngularJS-large.png"/>

                <h3>Working with ng-Model-Controller</h3>
            </section>
            <section>
                <!-- founder -->
                <img class="column two" src="images/me.jpg" title="Rhett Lowe" alt="Rhett Lowe"/>

                <div class="column two left-align">
                    <h2>Rhett Lowe</h2>
                    <br/>
                    <ul>
                        <li>Work at i-Showcase, Inc.</li>
                        <li>AngularJS for 9+ months</li>
                        <li><a href="https://github.com/rhettl">GitHub</a></li>
                        <li><a href="https://plus.google.com/+RhettLowe">Google+</a></li>
                    </ul>
                </div>
                <aside class="notes">
                    <p>this is me. I am not in many places yet and I haven't been on the scene long, but I have been
                        working hard and learning much.</p>
                </aside>
            </section>
        </section>

        <!--<section>-->
        <!--<h2>How it works</h2>-->
        <!--<pre ng-non-bindable><code data-trim>-->
        <!--<div ng-app>-->
        <!--Hello {{ who }}!<br /><br />-->
        <!--<input ng-model="who" type="text"/>-->
        <!--</div>-->
        <!--</code></pre>-->
        <!--<aside class="notes">-->
        <!--<p>This is the whole code. Notice:</p>-->
        <!--<ul>-->
        <!--<li>ng-app</li>-->
        <!--<li>Template Handlebars `{{ }}`</li>-->
        <!--<li>ng-model</li>-->
        <!--</ul>-->
        <!--</aside>-->
        <!--</section>-->
        <!--<pre class="inline"><code data-trim>null</code></pre>-->
        <section id="directives">
            <section>
                <h2>Directives</h2>
                <ul>
                    <li class="fragment">Encapsulated</li>
                    <li class="fragment">DOM Manipulation</li>
                    <li class="fragment">jQuery Goes Here</li>
                    <li class="fragment">Create/Clean after itself</li>
                </ul>
                <br/>
                <br/>
                <h4 class="fragment">Examples</h4>
                <ul class="fragment">
                    <li>ngList</li>
                    <li>ngSrc</li>
                    <li>ngHref</li>
                    <li>ngRepeat</li>
                </ul>
                <aside class="notes">
                    <h3>Directives</h3>
                    <ul>
                        <li>Should be self enclosed - Preferably no communication in and no communication out</li>
                        <li>jQuery - If there was a place for jQuery in Angular it is here. This is the best place for
                            any form of DOM manipulation.
                        </li>
                        <li>Directives should be in full control of its own creation and destruction.</li>
                    </ul>
                    <p>Directives can be used to modify the DOM, inputs, outputs and much more.</p>
                </aside>
            </section>
            <section>
                <h2>Normal Usage</h2>
                <pre ng-non-bindable><code data-trim>
angular.module('testApp', []).directive('pagination', [function () {
    return {
        restrict: 'A',
        scope: {
            span: '=',
            current: '=',
            total: '=',
            nextPrev: '=?',
            firstLast: '=?',
            changePage: '&'
        },
        templateURL: "/partials/paginate.html",
        link: function(scope, element, attrs) {
            //Creation and DOM Manipulation data goes here.
        }
    };
}]);
                </code></pre>
                <aside class="notes">
                    <h2>Basic usage of a directive</h2>
                    <ul>
                        <li>the angular.directive function to make the directive</li>
                        <li>Restrict set if the directive is an Attribute, Element, Class or Comment</li>
                        <li>in the directive you can create a child-scope to better encapsulate data</li>
                        <li>Template or templateUrl to direct the DOM</li>
                        <li>Link is the main function that is called to instantiate the new object into memory. It is where you place any events, watchers and manipulation algorithms</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h2>Range Slider</h2>
                <pre class="inline"><code data-trim><range-slider min="0" max="100" ng-model-low="low" ng-model-high="high"></range-slider></code></pre>
                <pre ng-non-bindable><code data-trim>
angular.module('jQueryUI', []).directive('rangeSlider', [function() {
    var noop = angular.noop;

    return {
        restrict: "EA",
        replace: true,
        template: '<div class="slider"></div>',
        scope: {
            step: '@?',
            min: '@',
            max: '@',
            ngModelLow: '=',
            ngModelHigh: '=',
            stop: '&?',
            slide: '&?'
        },
        link: function(scope, elem, attrs) {
            var slider,
            externalChange = function(){
                slider.slider('values', [scope.ngModelLow, scope.ngModelHigh]);
            },
            setValues = function(values){
                values = checkLowHigh(values);
                scope.$apply(function(){
                    scope.ngModelLow = values[0];
                    scope.ngModelHigh = values[1];
                });
            },
            checkLowHigh = function(vals){
                if (typeof vals === 'undefined' || vals.length !== 2)
                    vals = [min, max];

                var low = vals[0], high = vals[1];

                if (high < low){
                    var temp = high;
                    high = low; low = temp;
                    bounceBack = true;
                }
                if (low < min) {
                    low = min;
                    bounceBack = true;
                }
                if (high > max) {
                    high = max;
                    bounceBack = true;
                }

                return [low, high];
            };

            scope.stop = scope.stop || noop;
            scope.slide = scope.slide || noop;

            scope.min = parseFloat(scope.min);
            scope.max = parseFloat(scope.max);

            scope.step = typeof scope.step !== 'undefined' ? scope.step : 1;
            scope.ngModelLow = typeof scope.ngModelLow !== 'undefined' ? scope.ngModelLow : scope.min;
            scope.ngModelHigh = typeof scope.ngModelHigh !== 'undefined' ? scope.ngModelHigh : scope.max;

            slider = elem.slider({
                animate: true,
                range: true,
                step: scope.step,
                min: scope.min,
                max: scope.max,
                values: [scope.ngModelLow, scope.ngModelHigh],
                slide: function(e, ui){
                    setValues(ui.values);

                    scope.slide({
                        values: ui.values,
                        low: ui.values[0],
                        high: ui.values[1]
                    });
                },
                stop: function(e, ui){
                    scope.stop({
                        values: ui.values,
                        low: ui.values[0],
                        high: ui.values[1]
                    });
                }
            });

            scope.$watch('ngModelLow', externalChange);
            scope.$watch('ngModelHigh', externalChange);
        }
    };
}]);
                </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Break it apart</h2>
                <br />
                <ui>
                    <li class="fragment">(Complicated?) Child Scope</li>
                    <li class="fragment">scope.$watch() - ers</li>
                </ui>
                <aside class="notes">
                    While there are many things to point out in this I would like to mention 2:
                    <ul>
                        <li>There is a scope variable. This means it is creating a child scope. This is good and bad</li>
                        <li>We have to add Watchers to the Link function to listen to external changes</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h3>(Complicated?) Child Scope</h3>
                <pre ng-non-bindable><code data-trim>
angular.module('jQueryUI', []).directive('rangeSlider', [function() {
    var noop = angular.noop;
    
    return {
        restrict: "EA",
        scope: {
            step: '@?',
            min: '@',
            max: '@',
            ngModelLow: '=',
            ngModelHigh: '=',
            stop: '&?',
            slide: '&?'
        },
        link: function(scope, elem, attrs) {
            /*  Linking code Here  */
        }
    };
}]);
                </code></pre>
                <aside class="notes">
                    <h3>Child Scopes</h3>
                    <h5>Benefits</h5>
                    <ul>
                        <li>Easier to understand</li>
                        <li>Easier to read/write</li>
                        <li>Encapsulation</li>
                    </ul>
                    <br/>
                    <h5>Detriments</h5>
                    <ul>
                        <li>More weight on memory</li>
                        <li>More weight on processor</li>
                        <li>Extra layer to Penetrate</li>
                        <li>More watchers</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h3>scope.$watch() - ers</h3>

                <pre ng-non-bindable><code data-trim>
slide: function(e, ui){
    setValues(ui.values);

    scope.slide({
        values: ui.values,
        low: ui.values[0],
        high: ui.values[1]
    });
}
/* ... */
setValues = function(values){
    console.log('internal', values);
    values = checkLowHigh(values);
    scope.$apply(function(){
        scope.ngModelLow = values[0];
        scope.ngModelHigh = values[1];
    });
}
                </code></pre>
                <pre ng-non-bindable><code data-trim>
externalChange = function(){
    console.log('external', [scope.ngModelLow, scope.ngModelHigh]);
    slider.slider('values', [scope.ngModelLow, scope.ngModelHigh]);
}
                </code></pre>
                <pre ng-non-bindable><code data-trim>
scope.$watch('ngModelLow', externalChange);
scope.$watch('ngModelHigh', externalChange);
                </code></pre>
                <aside class="notes">
                    <h3>Watchers and Bouncing</h3>
                    <ul>
                        <li>The slider provides a nice way to update the the model</li>
                        <li>External Changes won't be reflected in the slider unless we watch for them</li>
                        <li>The Watcher is set to change the Slider</li>
                        <li>2 Way updating -> slider>>model and model>>slider</li>
                    </ul>
                    <br/>
                    <h3>Problems</h3>
                    <h5>Slider>>Model</h5>
                    <ul>
                        <li>Slider Changes</li>
                        <li>setValues() is triggered</li>
                        <li>'internal' is logged</li>
                    </ul>
                    <h5>Model>>Slider</h5>
                    <ul>
                        <li>Code changes model</li>
                        <li>Model triggers watcher triggering externalChange()</li>
                        <li>'external' is logged</li>
                        <li>Slider updates</li>
                        <li>setValues() is triggered</li>
                        <li>'internal' is logged</li>
                    </ul>
                    <h5>double update aka bouncing</h5>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <h2>Using ng-Model-Controller</h2>
                <br/>
                <ul>
                    <li class="fragment">require: "ngModel"</li>
                    <li class="fragment">include ngModel in link</li>
                    <li class="fragment">functions for 2-directional updating</li>
                    <li class="fragment">Parsers and Formatters</li>
                    <li class="fragment">$pristine, $error, and other form validations</li>
                </ul>
                <aside class="notes">
                    <ul>
                        <li>To start add a require to make sure you get a model to control</li>
                        <li>add the ngModel to the linking function so ou have something to bind to</li>
                        <li>ngModel gives you functions to control both directions of updates: i.e. model>>view/slider
                            and slider/view>>model
                        </li>
                        <li>Allows for a stack in both direction, formatters and parsers</li>
                        <li>Allows for settings like Error, Pristine, Required, Valid, Etc.</li>
                    </ul>
                </aside>
            </section>
            <section>
                <pre ng-non-bindable><code data-trim>
angular.module('jQueryUI', []).directive('rangeSlider', [function() {
    var noop = angular.noop;

    return {
        restrict: "EA",
        require: 'ngModel',
        link: function(scope, elem, attrs, ngModel) {
            if (!ngModel
                    || typeof attrs.min === 'undefined'
                    || typeof attrs.max === 'undefined'){
                return;
            }

            var slider, bounceBack = false,
            step = scope.$eval(attrs.step) || 1,
            min = scope.$eval(attrs.min),
            max = scope.$eval(attrs.max),
            checkLowHigh = function(vals){
                if (typeof vals === 'undefined' || vals.length !== 2)
                    vals = [min, max];

                var low = vals[0], high = vals[1];

                if (high < low){
                    var temp = high;
                    high = low; low = temp;
                    bounceBack = true;
                }
                if (low < min) {
                    low = min;
                    bounceBack = true;
                }
                if (high > max) {
                    high = max;
                    bounceBack = true;
                }

                return [low, high];
            };


            //ngModel.$parsers.push(checkLowHigh);
            ngModel.$formatters.push(checkLowHigh);

            slider = elem.slider({
                animate: true,
                range: true,
                step: step,
                min: min,
                max: max,
                values: ngModel.$viewValue,
                slide: function(e, ui){
                    scope.$apply(function(){
                        ngModel.$setViewValue(ui.values);
                    });
                },
                stop: function(e, ui){
                    scope.$apply(function(){
                        scope.$eval(attrs.ngStop, {
                            values: ui.values,
                            low: ui.values[0],
                            high: ui.values[1]
                        });
                    });
                }
            });

            ngModel.$render = function(){
                if (bounceBack) {
                    bounceBack = false;
                    ngModel.$setViewValue(ngModel.$viewValue);
                }
                slider.slider('values', ngModel.$viewValue);
            };
        }
    };
}]);
                </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Breaking it apart</h2>
            </section>
            <section>
                <h2>Getting the ng-Model-Controller</h2>
                <pre ng-non-bindable><code data-trim>
angular.module('jQueryUI', []).directive('rangeSlider', [function() {
    var noop = angular.noop;

    return {
        restrict: "EA",
        require: 'ngModel',
        link: function(scope, elem, attrs, ngModel) {
            if (!ngModel
                    || typeof attrs.min === 'undefined'
                    || typeof attrs.max === 'undefined'){
                return;
            }
            /* ... */
        }
    }
}]);
                </code></pre>
                <aside class="notes">
                    <h3>Including the controller</h3>
                    <ul>
                        <li>require: "ngModel" throws error if no ngModel</li>
                        <li>add 4th argument to linking function to give yourself an object for controlling the
                            ngModelController
                        </li>
                        <li>Now you can start adding functions and checking data</li>
                        <li>I saw this if statement somewhere and liked it. I find that it helps to make dead sure I have all requirements</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h2>2-directional updating</h2>
                <img class="logo column two" style="max-height: 550px; width: auto" src="images/modelToView.png"/>
                <img class="logo column two" style="max-height: 550px; width: auto" src="images/viewToModel.png"/>
            </section>
            <section>
                <h2>2-directional updating</h2>
                <pre ng-non-bindable><code data-trim>
slider = elem.slider({
    /* ... */
    values: ngModel.$viewValue,
    slide: function(e, ui){
        scope.$apply(function(){
            ngModel.$setViewValue(ui.values);
        });
    }
    /* ... */
});
                </code></pre>
                <pre ng-non-bindable><code data-trim>
ngModel.$render = function(){
    /* ... */

    slider.slider('values', ngModel.$viewValue);
};
                </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Formatters and Parsers</h2>
                <p>Modify and/or control the data comming in and going out of the ngModel</p>
            </section>
            <section>
                <img class="logo column two" style="max-height: 650px; width: auto" src="images/modelToView.png"/>
                <div class="column two">
                    <h3>Formatters</h3>
                    <ul>
                        <li class="fragment">Triggered by $modelValue change</li>
                        <li class="fragment">Check correctness of data</li>
                        <li class="fragment">Convert "Data" to "Displayable"</li>
                        <li class="fragment">Input[n] = Output[n-1]</li>
                        <li class="fragment">Finalizes with $render()</li>
                        <li class="fragment">$render is an interface</li>
                    </ul>
                </div>
            </section>
            <section>
                <div class="column two">
                    <h3>Parsers</h3>
                    <ul>
                        <li class="fragment">Triggered by $setViewValue()</li>
                        <li class="fragment">Convert "Displayable" to "Data"</li>
                        <li class="fragment">Input[n] = Output[n+1]</li>
                    </ul>
                </div>
                <img class="logo column two" style="max-height: 650px; width: auto" src="images/viewToModel.png"/>
            </section>
            <section>
                <h3>Formatting Function</h3>
                <pre ng-non-bindable><code data-trim>
var checkLowHigh = function(vals){
    if (typeof vals === 'undefined' || vals.length !== 2)
        vals = [min, max];

    var low = vals[0], high = vals[1];

    if (high < low){
        var temp = high;
        high = low; low = temp;
    }
    if (low < min) {
        low = min;
    }
    if (high > max) {
        high = max;
    }

    return [low, high];
};

//ngModel.$parsers.unshift(checkLowHigh);
ngModel.$formatters.push(checkLowHigh);
                </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Forms Functionality</h2>
                <ul>
                    <li class="fragment">$valid / $invalid</li>
                    <li class="fragment">$pristine / $dirty</li>
                    <li class="fragment">$error</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>Online</h2>

                <p><a href="https://www.github.com/rhettl/ngModelController-slides">github.com/rhettl/ngModelController-slides</a></p>
            </section>
        </section>
    </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>
<script src="js/angular.min.js"></script>
<script src="js/app/application.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            } },
            { src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            } },
            { src: 'plugin/notes/notes.js', async: true, condition: function () {
                return !!document.body.classList;
            } }

        ]
    });

</script>

</body>
</html>
